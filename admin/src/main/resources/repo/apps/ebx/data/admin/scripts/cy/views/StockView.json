{"type":"cy:bean","properties":{"beanType@STRING":"cy:requiremodule","name@STRING":"StockView","dependencies@STRING":["/libs/bndly/data/scripts/cy/ui/Text","/libs/bndly/data/scripts/cy/RestBeans","/libs/bndly/data/scripts/cy/ui/ViewComponent"],"script@STRING":"var StockView = ViewComponent.extend({\r\n\tconstruct: function(config) {\r\n\t\tif (!config) {\r\n\t\t\tconfig = {};\r\n\t\t}\r\n\r\n\t\tthis.callSuper(arguments, config);\r\n\t\tthis.listen(this.parent, \"reloaded\", this.loadStockItem, this);\r\n\t\tthis.stockLabel = new Text({});\r\n\t},\r\n\trenderTo: function(renderTarget) {\r\n\t\tthis.stockLabel.renderTo(renderTarget);\r\n\t\tthis.invokeSuper(arguments);\r\n\t\tthis.loadStockItem();\r\n\t},\r\n\tdestroy: function() {\r\n\t\tthis.invokeSuper(arguments);\r\n\t\tthis.stockLabel.destroy();\r\n\t},\r\n\tloadStockItem: function() {\r\n\t\tif (this.parent.getSku()) {\r\n\t\t\tvar si = new RestBeans[\"StockItemRestBean\"]();\r\n\t\t\tsi.setSku(this.parent.getSku());\r\n\t\t\tsi.addSingleInvocationListener(\"found\", function() {\r\n\t\t\t\tsi.addSingleInvocationListener(\"reloaded\", this.didLoadStockItem, this);\r\n\t\t\t}, this);\r\n\t\t\tsi.addSingleInvocationListener(\"notFound\", function() {\r\n\t\t\t\tthis.didNotFindStockItem();\r\n\t\t\t}, this);\r\n\t\t\tsi.find();\r\n\t\t} else {\r\n\t\t\tthis.stockLabel.value.set(\"There is no SKU defined to look up the current stock.\");\r\n\t\t}\r\n\t},\r\n\tdidLoadStockItem: function(si) {\r\n\t\tthis.stockLabel.value.set(\"There are \"+si.getStock()+\" items on stock.\");\r\n\t},\r\n\tdidNotFindStockItem: function() {\r\n\t\tthis.stockLabel.value.set(\"There are 0 items on stock.\");\r\n\t}\r\n});\r\nreturn StockView;","initMethod@STRING":"","proxy@STRING":"","moduleId@STRING":""}}