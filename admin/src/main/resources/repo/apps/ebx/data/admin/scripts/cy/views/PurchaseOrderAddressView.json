{"type":"cy:bean","properties":{"beanType@STRING":"cy:requiremodule","name@STRING":"PurchaseOrderAddressView","dependencies@STRING":["/libs/bndly/data/scripts/cy/ui/container/InputViewContainer","/libs/bndly/data/scripts/cy/ui/container/Form","/libs/bndly/data/scripts/cy/RestBeans","/apps/ebx/data/admin/scripts/cy/form/AddressRestBean","/libs/bndly/data/scripts/cy/FormBinder","/libs/bndly/data/scripts/cy/FieldSet","/libs/bndly/data/scripts/cy/ui/input/Button","/libs/bndly/data/scripts/cy/ui/container/ViewContainer"],"script@STRING":"var PurchaseOrderAddressView = ViewContainer.extend({\r\n\tconstruct: function(config) {\r\n\t\tif (!config) {\r\n\t\t\tconfig = {};\r\n\t\t}\r\n\t\tvar deliveryAddressHidden,billingAddressHidden;\r\n\t\tconfig.order = config.parent;\r\n\t\tconfig.address = config.order.getAddress();\r\n\t\tif (!config.address) {\r\n\t\t\tconfig.address = new RestBeans[\"AddressRestBean\"]();\r\n\t\t\tconfig.order.setAddress(config.address);\r\n\t\t}\r\n\t\tconfig.billingAddress = config.order.getBillingAddress();\r\n\t\tif (!config.billingAddress) {\r\n\t\t\tbillingAddressHidden = true;\r\n\t\t\tconfig.billingAddress = new RestBeans[\"AddressRestBean\"]();\r\n\t\t} else {\r\n\t\t\tbillingAddressHidden = config.billingAddress.hasLink(\"self\") != null;\r\n\t\t}\r\n\t\tconfig.deliveryAddress = config.order.getDeliveryAddress();\r\n\t\tif (!config.deliveryAddress) {\r\n\t\t\tdeliveryAddressHidden = true;\r\n\t\t\tconfig.deliveryAddress = new RestBeans[\"AddressRestBean\"]();\r\n\t\t} else {\r\n\t\t\tdeliveryAddressHidden = config.deliveryAddress.hasLink(\"self\") != null;\r\n\t\t}\r\n\t\tconfig.items = [\r\n\t\t\tthis.buildAddressForm(\"address\", \"Address\", config.address, false),\r\n\t\t\tthis.buildAddressForm(\"billingAddress\", \"Billing Address\", config.billingAddress, true, billingAddressHidden),\r\n\t\t\tthis.buildAddressForm(\"deliveryAddress\", \"Delivery Address\", config.deliveryAddress, true, deliveryAddressHidden)\r\n\t\t];\r\n\t\tthis.callSuper(arguments, config);\r\n\t},\r\n\tbuildAddressForm: function(member, title, address, optional, hidden) {\r\n\t\tvar rawItems = [], ivc = new InputViewContainer({\r\n\t\t\titems: rawItems,\r\n\t\t\thidden: hidden\r\n\t\t}), fs = new FieldSet({\r\n\t\t\tlegend: title,\r\n\t\t\titems: [ivc]\r\n\t\t});\r\n\t\t\r\n\t\tvar items = [fs];\r\n\r\n\t\tnew FormBinder({\r\n\t\t\tentity: address,\r\n\t\t\tsections: AddressRestBean\r\n\t\t}).renderMembersToForm(address, rawItems, {});\r\n\t\t\r\n\t\tif (optional) {\r\n\t\t\tfs.items.add(new Button({\r\n\t\t\t\tlabel: \"edit\",\r\n\t\t\t\tlisteners: {\r\n\t\t\t\t\tclicked: {\r\n\t\t\t\t\t\tfn: function(button) {\r\n\t\t\t\t\t\t\tivc.show();\r\n\t\t\t\t\t\t\tthis.editAddress(button, member);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tscope: this\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t\tfs.items.add(new Button({\r\n\t\t\t\tlabel: \"delete\",\r\n\t\t\t\tlisteners: {\r\n\t\t\t\t\tclicked: {\r\n\t\t\t\t\t\tfn: function(button) {\r\n\t\t\t\t\t\t\tivc.hide();\r\n\t\t\t\t\t\t\tthis.removeAddress(button, member);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tscope: this\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\t\t\r\n\t\treturn new Form({\r\n\t\t\titems: items\r\n\t\t});\r\n\t},\r\n\tdestroy: function() {\r\n\t\tthis.invokeSuper(arguments);\r\n\t},\r\n\trenderTo: function(renderTarget) {\r\n\t\tthis.invokeSuper(arguments);\r\n\t},\r\n\tremoveAddress: function(button, member) {\r\n\t\tthis.order.set(member, null);\r\n\t},\r\n\teditAddress: function(button, member) {\r\n\t\tthis.order.set(member, this[member]);\r\n\t}\r\n});\r\nreturn PurchaseOrderAddressView;","initMethod@STRING":"","proxy@STRING":"","moduleId@STRING":""}}